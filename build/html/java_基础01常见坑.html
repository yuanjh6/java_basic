

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>java_基础01常见坑 &mdash; java基础 v1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="java_基础02集合" href="java_基础02集合.html" />
    <link rel="prev" title="java_读书05殷建卫架构笔记之java" href="java_读书05殷建卫架构笔记之java.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> java基础
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="java_读书01guide学习笔记.html">java_读书01guide学习笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_读书02java核心面试知识整理.html">java_读书02java核心面试知识整理</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_读书03Java基础高频面试题(2021年最新版).html">java_读书03Java基础高频面试题(2021年最新版)</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_读书05殷建卫架构笔记之java.html">java_读书05殷建卫架构笔记之java</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">java_基础01常见坑</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">对象池</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integer">Integer类有缓存</a></li>
<li class="toctree-l2"><a class="reference internal" href="#object-tostring">Object.toString那些不为人知的事情</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">逻辑运算符的“短路”现象</a></li>
<li class="toctree-l2"><a class="reference internal" href="#javaunicode">Java注释能够识别Unicode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">参考</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="java_基础02集合.html">java_基础02集合</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_基础03双亲委派.html">java_基础03双亲委派</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_基础04内存结构和gc垃圾回收.html">java_基础04内存结构和gc垃圾回收</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程01JMM内存模型.html">java_并发编程01JMM内存模型</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程02Volatile.html">java_并发编程02Volatile</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程03Atomic原子类和CAS.html">java_并发编程03Atomic原子类和CAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程04Synchronized.html">java_并发编程04Synchronized</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程05从锁到ReentrantLock.html">java_并发编程05从锁到ReentrantLock</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程06从ReentrantLock到AQS.html">java_并发编程06从ReentrantLock到AQS</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程07锁相关小结.html">java_并发编程07锁相关小结</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程08CyclicBarrier_CountDownLatch_Semaphore.html">java_并发编程08CyclicBarrier_CountDownLatch_Semaphore</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程09ThreadLocal.html">java_并发编程09ThreadLocal</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程10阻塞队列.html">java_并发编程10阻塞队列</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_并发编程11线程池.html">java_并发编程11线程池</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_spring01读书要点.html">java_spring01读书要点</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_spring02ioc有什么优点.html">java_spring02ioc有什么优点</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_spring03依赖注入与自动装配区别.html">java_spring03依赖注入与自动装配区别</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_spring04Autowired与Resource差异解析.html">java_spring04Autowired与Resource差异解析</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_spring05循环依赖.html">java_spring05循环依赖</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_mybatis学习要点.html">java_mybatis学习要点</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_微服务01学习笔记.html">java_微服务01学习笔记</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">java基础</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>java_基础01常见坑</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/java_基础01常见坑.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="java-01">
<h1>java_基础01常见坑<a class="headerlink" href="#java-01" title="Permalink to this headline">¶</a></h1>
<p>常见坑整理</p>
<div class="section" id="id1">
<h2>对象池<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>==比较的是引用，不是内容</p>
<p>让人更混乱的是，有时候用==是能比较内容的。如果你有两个一样的不可变值，JVM会尝试引用 同一个对象 。</p>
<p>String s1 = “Hi”, s2 = “Hi”;</p>
<p>Integer a = 12, b = 12;</p>
<p>这两个例子中用到了对象池，所以最后引用 的是同样的对象。s1==s2和a==b都是返回true,JVM已经把两个引用 都指向了同一个对象。然而，如果稍微改下代码，JVM没有把对象放到池里的话，==就会返回false，可能会让你意想不到。这个时候你得用equals 了。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">new</span> <span class="n">String</span><span class="p">(</span><span class="n">s1</span><span class="p">);</span>  
<span class="n">Integer</span> <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">222</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="mi">222</span><span class="p">;</span>  
<span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span>      <span class="o">//</span> <span class="ow">is</span> <span class="n">true</span>  
<span class="n">s1</span> <span class="o">==</span> <span class="n">s3</span>      <span class="o">//</span> <span class="ow">is</span> <span class="n">false</span>  
<span class="n">s1</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span> <span class="o">//</span> <span class="ow">is</span> <span class="n">true</span>  
<span class="n">a</span> <span class="o">==</span> <span class="n">b</span>        <span class="o">//</span> <span class="ow">is</span> <span class="n">true</span>  
<span class="n">c</span> <span class="o">==</span> <span class="n">d</span>        <span class="o">//</span> <span class="ow">is</span> <span class="n">false</span> <span class="p">(</span><span class="n">different</span> <span class="n">objects</span> <span class="n">were</span> <span class="n">created</span><span class="p">)</span>  
<span class="n">c</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>   <span class="o">//</span> <span class="ow">is</span> <span class="n">true</span>  
</pre></div>
</div>
<p>对于整型来说，对象池缓存的范围是-128到127（还有可能更高）。</p>
</div>
<div class="section" id="integer">
<h2>Integer类有缓存<a class="headerlink" href="#integer" title="Permalink to this headline">¶</a></h2>
<p>这个功能点也是面试的高频热点之一，稍不注意，也有可能被带入沟里，我们看看下面这段代码：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">){</span>
   <span class="n">Integer</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
   <span class="n">Integer</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
   <span class="n">Integer</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
   <span class="n">Integer</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
   <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="n">b</span><span class="p">);</span>
   <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="n">d</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>上面的代码竟然输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">true</span>
<span class="n">false</span>
</pre></div>
</div>
</div>
<div class="section" id="object-tostring">
<h2>Object.toString那些不为人知的事情<a class="headerlink" href="#object-tostring" title="Permalink to this headline">¶</a></h2>
<p>Object.toString那些不为人知的事情</p>
<p>toString的默认行为是打印类的的内部名 称还有对象的hashCode。 上面已经提到，hashCode并不是内存地址，尽管它是用16进制打印的。同样的，类名，尤其是数组的类名，更容易让人头晕。比如说String[]的 名称是[Ljava.lang.String; 这个[表明它是个数组，L说明它是Java语言（Language）创建的类，并不是基础类型比如byte这些，顺便提一下byte内部名称是B。;号标 识类的结束。比如你有个这样的数组：</p>
<p>String[] words = { “Hello”, “World” };</p>
<p>System.out.println(words);</p>
<p>输出会是这样：</p>
<p>[Ljava.lang.String;&#64;45ee12a7</p>
<p>很不幸你只知道这是个对象数组。如果你只有一个Object实例words，这样是不够的，你得调用下Arrays.toString(words)。这极其恶劣地破坏了封装的原则，在StackOverflow上面这也是最常见的一类问题。</p>
<p>我问过Oracle的好些个工程师，从他们的反馈感觉，这个问题目前很难解决。</p>
</div>
<div class="section" id="id2">
<h2>逻辑运算符的“短路”现象<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>使用逻辑运算符时，我们会遇到“短路”的现象：一旦能够确定整个表达式的值，就不会计算余下的部分了，当然，这个功能点其实是非常有用的，但对于初学者来说，可能会感觉比较惊讶，使用不当就会产生“坑爹”后果。比如下面的代码：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  
<span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">false</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="n">num</span><span class="o">++</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">));</span>  
<span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>  
</pre></div>
</div>
<p>就会输出false和1，因为逻辑与&amp;&amp;的前半部分为false，不管后半部分为true还是false，整个表达式都会返回false，所以就不会再计算后面的部分了，如果把false改成true，那么后半部分就会得到执行，num也就变成2了。</p>
</div>
<div class="section" id="javaunicode">
<h2>Java注释能够识别Unicode<a class="headerlink" href="#javaunicode" title="Permalink to this headline">¶</a></h2>
<p>先看看代码：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">){</span>
    <span class="o">//</span> \<span class="n">u000d</span> <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>乍一看，代码都被注释掉了，当然不会输出任何东西，然而，它还是输出每个程序员都倍感亲切的Hello World，这是因为，unicode解码发生在代码编译之前，编译器将\u样式的代码进行文本转义，即使是注释也是这样，然后\u000a被转换成\n换行符，所以println代码得以正常执行。</p>
<p>这样的功能着实“坑爹”，极其违反常识，它必须要上榜，必须要荣登状元的位置。</p>
</div>
<div class="section" id="id3">
<h2>参考<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Java中常见的坑：http://doc.okbase.net/flycars001/archive/86504.html</p>
<p>Java 语言中十大“陷阱”你遇到过几个？：https://blog.csdn.net/weixin_42784331/article/details/104303549</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="java_基础02集合.html" class="btn btn-neutral float-right" title="java_基础02集合" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="java_读书05殷建卫架构笔记之java.html" class="btn btn-neutral float-left" title="java_读书05殷建卫架构笔记之java" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, yuanjh

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>